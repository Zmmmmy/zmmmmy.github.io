

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/images/avatar.png">
  <link rel="icon" href="/images/favicon-32x32.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#f5f5f5">
  <meta name="author" content="ZhiMy">
  <meta name="keywords" content="æŠ€æœ¯åšå®¢,ç¼–ç¨‹">
  
    <meta name="description" content="Spring AI Tool Calling è¯¦è§£æ¦‚è¿°Tool Callingï¼ˆå·¥å…·è°ƒç”¨ï¼‰æ˜¯ Spring AI æ¡†æ¶ä¸­è®© AI æ¨¡å‹ä¸å¤–éƒ¨ä¸–ç•Œäº¤äº’çš„æ ¸å¿ƒèƒ½åŠ›ã€‚å®ƒå…è®¸ AI æ¨¡å‹åœ¨å¯¹è¯è¿‡ç¨‹ä¸­è¯†åˆ«éœ€è¦è°ƒç”¨å¤–éƒ¨å·¥å…·çš„æ—¶æœºï¼Œç”Ÿæˆç»“æ„åŒ–çš„è°ƒç”¨å‚æ•°ï¼Œæ‰§è¡Œå·¥å…·åå°†ç»“æœèå…¥å¯¹è¯ã€‚  ğŸ’¡ æç¤º: ä¸ Function Calling çš„å…³ç³»Tool Calling æ˜¯ Spring AI å¯¹å„å¤§æ¨¡å‹å‚å•† Fun">
<meta property="og:type" content="article">
<meta property="og:title" content="Tool Callingè¯¦è§£">
<meta property="og:url" content="https://zmmmmy.github.io/2026/01/28/Tool%20Calling%E8%AF%A6%E8%A7%A3/index.html">
<meta property="og:site_name" content="Zmmmmy&#39;s Blog">
<meta property="og:description" content="Spring AI Tool Calling è¯¦è§£æ¦‚è¿°Tool Callingï¼ˆå·¥å…·è°ƒç”¨ï¼‰æ˜¯ Spring AI æ¡†æ¶ä¸­è®© AI æ¨¡å‹ä¸å¤–éƒ¨ä¸–ç•Œäº¤äº’çš„æ ¸å¿ƒèƒ½åŠ›ã€‚å®ƒå…è®¸ AI æ¨¡å‹åœ¨å¯¹è¯è¿‡ç¨‹ä¸­è¯†åˆ«éœ€è¦è°ƒç”¨å¤–éƒ¨å·¥å…·çš„æ—¶æœºï¼Œç”Ÿæˆç»“æ„åŒ–çš„è°ƒç”¨å‚æ•°ï¼Œæ‰§è¡Œå·¥å…·åå°†ç»“æœèå…¥å¯¹è¯ã€‚  ğŸ’¡ æç¤º: ä¸ Function Calling çš„å…³ç³»Tool Calling æ˜¯ Spring AI å¯¹å„å¤§æ¨¡å‹å‚å•† Fun">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2026-01-27T16:00:00.000Z">
<meta property="article:modified_time" content="2026-02-24T02:47:39.072Z">
<meta property="article:author" content="ZhiMy">
<meta property="article:tag" content="AI">
<meta property="article:tag" content="Agent">
<meta property="article:tag" content="FunctionCalling">
<meta property="article:tag" content="SpringAI">
<meta property="article:tag" content="ToolCalling">
<meta name="twitter:card" content="summary_large_image">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>Tool Callingè¯¦è§£ - Zmmmmy&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/custom.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"zmmmmy.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":false,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  



  
<meta name="generator" content="Hexo 8.1.1"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Zmmmmy&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>å½’æ¡£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>åˆ†ç±»</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>æ ‡ç­¾</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>å…³äº</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" false
     style="background: url('/img/banner.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Tool Callingè¯¦è§£"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2026-01-28 00:00" pubdate>
          2026å¹´1æœˆ28æ—¥ å‡Œæ™¨
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          2.8k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          24 åˆ†é’Ÿ
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> æ¬¡
        </span>
        

      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">Tool Callingè¯¦è§£</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="Spring-AI-Tool-Calling-è¯¦è§£"><a href="#Spring-AI-Tool-Calling-è¯¦è§£" class="headerlink" title="Spring AI Tool Calling è¯¦è§£"></a>Spring AI Tool Calling è¯¦è§£</h1><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>Tool Callingï¼ˆå·¥å…·è°ƒç”¨ï¼‰æ˜¯ Spring AI æ¡†æ¶ä¸­è®© AI æ¨¡å‹ä¸å¤–éƒ¨ä¸–ç•Œäº¤äº’çš„æ ¸å¿ƒèƒ½åŠ›ã€‚å®ƒå…è®¸ AI æ¨¡å‹åœ¨å¯¹è¯è¿‡ç¨‹ä¸­è¯†åˆ«éœ€è¦è°ƒç”¨å¤–éƒ¨å·¥å…·çš„æ—¶æœºï¼Œç”Ÿæˆç»“æ„åŒ–çš„è°ƒç”¨å‚æ•°ï¼Œæ‰§è¡Œå·¥å…·åå°†ç»“æœèå…¥å¯¹è¯ã€‚</p>
<blockquote>
<p><strong>ğŸ’¡ æç¤º: ä¸ Function Calling çš„å…³ç³»</strong><br>Tool Calling æ˜¯ Spring AI å¯¹å„å¤§æ¨¡å‹å‚å•† Function Calling èƒ½åŠ›çš„ç»Ÿä¸€å°è£…ï¼Œæä¾›äº†æ›´åŠ  Spring å‹å¥½çš„ç¼–ç¨‹æ¨¡å‹ã€‚</p>
</blockquote>
<hr>
<h2 id="æ ¸å¿ƒæ¶æ„"><a href="#æ ¸å¿ƒæ¶æ„" class="headerlink" title="æ ¸å¿ƒæ¶æ„"></a>æ ¸å¿ƒæ¶æ„</h2><h3 id="æ•´ä½“æµç¨‹"><a href="#æ•´ä½“æµç¨‹" class="headerlink" title="æ•´ä½“æµç¨‹"></a>æ•´ä½“æµç¨‹</h3><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br>â”‚   ç”¨æˆ·è¯·æ±‚   â”‚â”€â”€â”€â”€â–ºâ”‚  ChatClient â”‚â”€â”€â”€â”€â–ºâ”‚  ChatModel  â”‚â”€â”€â”€â”€â–ºâ”‚   AI æ¨¡å‹   â”‚<br>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<br>                           â”‚                   â”‚                    â”‚<br>                           â”‚                   â”‚                    â”‚<br>                           â–¼                   â–¼                    â–¼<br>                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br>                    â”‚   Tools     â”‚â—„â”€â”€â”€â”€â”‚ToolCalling  â”‚â—„â”€â”€â”€â”€â”‚  å·¥å…·è°ƒç”¨   â”‚<br>                    â”‚  (å·¥å…·å®ç°)  â”‚     â”‚  Manager    â”‚     â”‚   æ„å›¾      â”‚<br>                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<br></code></pre></td></tr></table></figure>

<h3 id="å…³é”®ç»„ä»¶"><a href="#å…³é”®ç»„ä»¶" class="headerlink" title="å…³é”®ç»„ä»¶"></a>å…³é”®ç»„ä»¶</h3><table>
<thead>
<tr>
<th>ç»„ä»¶</th>
<th>èŒè´£</th>
</tr>
</thead>
<tbody><tr>
<td><code>@Tool</code></td>
<td>æ³¨è§£ï¼Œå°†æ–¹æ³•æ ‡è®°ä¸ºå¯è¢« AI è°ƒç”¨çš„å·¥å…·</td>
</tr>
<tr>
<td><code>@ToolParam</code></td>
<td>æ³¨è§£ï¼Œæè¿°å·¥å…·å‚æ•°çš„å…ƒä¿¡æ¯</td>
</tr>
<tr>
<td><code>ToolCallback</code></td>
<td>æ¥å£ï¼Œå·¥å…·æ‰§è¡Œçš„æ ¸å¿ƒæŠ½è±¡</td>
</tr>
<tr>
<td><code>ToolDefinition</code></td>
<td>å·¥å…·å®šä¹‰ï¼ˆåç§°ã€æè¿°ã€è¾“å…¥ Schemaï¼‰</td>
</tr>
<tr>
<td><code>ToolCallingManager</code></td>
<td>ç®¡ç†å·¥å…·æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ</td>
</tr>
<tr>
<td><code>ChatClient</code></td>
<td>å®¢æˆ·ç«¯ï¼Œæ³¨å†Œå’Œè°ƒç”¨å·¥å…·çš„å…¥å£</td>
</tr>
</tbody></table>
<hr>
<h2 id="Tool-Specificationï¼ˆå·¥å…·è§„èŒƒï¼‰"><a href="#Tool-Specificationï¼ˆå·¥å…·è§„èŒƒï¼‰" class="headerlink" title="Tool Specificationï¼ˆå·¥å…·è§„èŒƒï¼‰"></a>Tool Specificationï¼ˆå·¥å…·è§„èŒƒï¼‰</h2><p>Spring AI æä¾›ä¸¤ç§å®šä¹‰å·¥å…·çš„æ–¹å¼ï¼š<strong>Declarativeï¼ˆå£°æ˜å¼ï¼‰</strong> å’Œ <strong>Programmaticï¼ˆç¼–ç¨‹å¼ï¼‰</strong>ã€‚</p>
<h3 id="å¯¹æ¯”æ€»ç»“"><a href="#å¯¹æ¯”æ€»ç»“" class="headerlink" title="å¯¹æ¯”æ€»ç»“"></a>å¯¹æ¯”æ€»ç»“</h3><table>
<thead>
<tr>
<th>ç»´åº¦</th>
<th>Declarativeï¼ˆå£°æ˜å¼ï¼‰</th>
<th>Programmaticï¼ˆç¼–ç¨‹å¼ï¼‰</th>
</tr>
</thead>
<tbody><tr>
<td><strong>å®ç°æ–¹å¼</strong></td>
<td><code>@Tool</code> + <code>@ToolParam</code> æ³¨è§£</td>
<td><code>MethodToolCallback</code> &#x2F; <code>FunctionToolCallback</code></td>
</tr>
<tr>
<td><strong>Schema ç”Ÿæˆ</strong></td>
<td>è‡ªåŠ¨ï¼ˆåŸºäºæ–¹æ³•ç­¾åï¼‰</td>
<td>æ‰‹åŠ¨å®šä¹‰ <code>inputSchema</code></td>
</tr>
<tr>
<td><strong>çµæ´»æ€§</strong></td>
<td>ä½ï¼ˆä¾èµ–æ³¨è§£å±æ€§ï¼‰</td>
<td>é«˜ï¼ˆå®Œå…¨æ§åˆ¶æ‰€æœ‰é…ç½®ï¼‰</td>
</tr>
<tr>
<td><strong>é€‚ç”¨åœºæ™¯</strong></td>
<td>å¤§å¤šæ•°å¸¸è§„åœºæ™¯</td>
<td>åŠ¨æ€å·¥å…·ã€å¤æ‚å®šåˆ¶éœ€æ±‚</td>
</tr>
<tr>
<td><strong>ä»£ç é‡</strong></td>
<td>å°‘</td>
<td>å¤š</td>
</tr>
</tbody></table>
<h3 id="ToolDefinition-æ¥å£"><a href="#ToolDefinition-æ¥å£" class="headerlink" title="ToolDefinition æ¥å£"></a>ToolDefinition æ¥å£</h3><p>æ— è®ºå“ªç§æ–¹å¼ï¼Œæœ€ç»ˆéƒ½ä¼šç”Ÿæˆ <code>ToolDefinition</code>ï¼Œè¿™æ˜¯ AI æ¨¡å‹ç†è§£å·¥å…·çš„æ ¸å¿ƒï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ToolDefinition</span> &#123;<br>    String <span class="hljs-title function_">name</span><span class="hljs-params">()</span>;         <span class="hljs-comment">// å·¥å…·å”¯ä¸€åç§°</span><br>    String <span class="hljs-title function_">description</span><span class="hljs-params">()</span>;  <span class="hljs-comment">// å·¥å…·æè¿°ï¼ˆAI æ®æ­¤åˆ¤æ–­ä½•æ—¶è°ƒç”¨ï¼‰</span><br>    String <span class="hljs-title function_">inputSchema</span><span class="hljs-params">()</span>;  <span class="hljs-comment">// å‚æ•°çš„ JSON Schema</span><br>&#125;<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="å®šä¹‰å·¥å…·çš„ä¸‰ç§æ–¹å¼"><a href="#å®šä¹‰å·¥å…·çš„ä¸‰ç§æ–¹å¼" class="headerlink" title="å®šä¹‰å·¥å…·çš„ä¸‰ç§æ–¹å¼"></a>å®šä¹‰å·¥å…·çš„ä¸‰ç§æ–¹å¼</h2><h3 id="æ–¹å¼ä¸€ï¼š-Tool-æ³¨è§£ï¼ˆDeclarativeï¼Œæ¨èï¼‰"><a href="#æ–¹å¼ä¸€ï¼š-Tool-æ³¨è§£ï¼ˆDeclarativeï¼Œæ¨èï¼‰" class="headerlink" title="æ–¹å¼ä¸€ï¼š@Tool æ³¨è§£ï¼ˆDeclarativeï¼Œæ¨èï¼‰"></a>æ–¹å¼ä¸€ï¼š@Tool æ³¨è§£ï¼ˆDeclarativeï¼Œæ¨èï¼‰</h3><p>æœ€ç®€æ´çš„å£°æ˜å¼æ–¹å¼ï¼ŒSpring AI è‡ªåŠ¨ç”Ÿæˆ JSON Schemaã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.ai.tool.annotation.Tool;<br><span class="hljs-keyword">import</span> org.springframework.ai.tool.annotation.ToolParam;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WeatherService</span> &#123;<br><br>    <span class="hljs-meta">@Tool(description = &quot;è·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”ä¿¡æ¯&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getWeather</span><span class="hljs-params">(</span><br><span class="hljs-params">            <span class="hljs-meta">@ToolParam(description = &quot;åŸå¸‚åç§°ï¼Œå¦‚ï¼šåŒ—äº¬ã€ä¸Šæµ·&quot;)</span> String city,</span><br><span class="hljs-params">            <span class="hljs-meta">@ToolParam(description = &quot;æ¸©åº¦å•ä½ï¼šcelsius æˆ– fahrenheit&quot;)</span> String unit)</span> &#123;<br>        <span class="hljs-comment">// å®é™…è°ƒç”¨å¤©æ°” API</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;å½“å‰ &quot;</span> + city + <span class="hljs-string">&quot; å¤©æ°”ï¼šæ™´ï¼Œæ¸©åº¦ 25Â°C&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p><strong>âš ï¸ é‡è¦: @Tool æ³¨è§£å±æ€§</strong></p>
<ul>
<li><code>description</code>ï¼šå·¥å…·æè¿°ï¼ŒAI æ¨¡å‹æ ¹æ®æ­¤å†³å®šä½•æ—¶è°ƒç”¨ï¼ˆ<strong>å¿…å¡«</strong>ï¼‰</li>
<li><code>returnDirect</code>ï¼šæ˜¯å¦ç›´æ¥è¿”å›ç»“æœç»™ç”¨æˆ·ï¼Œè·³è¿‡æ¨¡å‹åå¤„ç†ï¼ˆé»˜è®¤ <code>false</code>ï¼‰</li>
</ul>
</blockquote>
<h3 id="æ–¹å¼äºŒï¼šMethodToolCallbackï¼ˆProgrammaticï¼‰"><a href="#æ–¹å¼äºŒï¼šMethodToolCallbackï¼ˆProgrammaticï¼‰" class="headerlink" title="æ–¹å¼äºŒï¼šMethodToolCallbackï¼ˆProgrammaticï¼‰"></a>æ–¹å¼äºŒï¼šMethodToolCallbackï¼ˆProgrammaticï¼‰</h3><p>å½“éœ€è¦æ›´ç²¾ç»†æ§åˆ¶æ—¶ä½¿ç”¨ï¼Œå¯å®Œå…¨è‡ªå®šä¹‰ <code>ToolDefinition</code>ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.ai.tool.MethodToolCallback;<br><span class="hljs-keyword">import</span> org.springframework.ai.tool.ToolDefinition;<br><span class="hljs-keyword">import</span> org.springframework.ai.tool.ToolDefinitions;<br><span class="hljs-keyword">import</span> org.springframework.util.ReflectionUtils;<br><br><span class="hljs-comment">// æ–¹å¼ Aï¼šå®Œå…¨æ‰‹åŠ¨æ„å»º</span><br><span class="hljs-type">Method</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> WeatherService.class.getMethod(<span class="hljs-string">&quot;getWeather&quot;</span>, String.class, String.class);<br><br><span class="hljs-type">ToolCallback</span> <span class="hljs-variable">toolCallback</span> <span class="hljs-operator">=</span> MethodToolCallback.builder()<br>    .toolDefinition(ToolDefinition.builder()<br>        .name(<span class="hljs-string">&quot;getWeather&quot;</span>)<br>        .description(<span class="hljs-string">&quot;è·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”ä¿¡æ¯&quot;</span>)<br>        .inputSchema(<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">            &#123;</span><br><span class="hljs-string">                &quot;type&quot;: &quot;object&quot;,</span><br><span class="hljs-string">                &quot;properties&quot;: &#123;</span><br><span class="hljs-string">                    &quot;city&quot;: &#123;&quot;type&quot;: &quot;string&quot;, &quot;description&quot;: &quot;åŸå¸‚åç§°&quot;&#125;,</span><br><span class="hljs-string">                    &quot;unit&quot;: &#123;&quot;type&quot;: &quot;string&quot;, &quot;enum&quot;: [&quot;celsius&quot;, &quot;fahrenheit&quot;]&#125;</span><br><span class="hljs-string">                &#125;,</span><br><span class="hljs-string">                &quot;required&quot;: [&quot;city&quot;]</span><br><span class="hljs-string">            &#125;</span><br><span class="hljs-string">            &quot;&quot;&quot;</span>)<br>        .build())<br>    .toolMethod(method)<br>    .toolObject(<span class="hljs-keyword">new</span> <span class="hljs-title class_">WeatherService</span>())<br>    .build();<br><br><span class="hljs-comment">// æ–¹å¼ Bï¼šä»æ–¹æ³•è‡ªåŠ¨ç”Ÿæˆ ToolDefinitionï¼Œå†è‡ªå®šä¹‰éƒ¨åˆ†å±æ€§</span><br><span class="hljs-type">Method</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> ReflectionUtils.findMethod(DateTimeTools.class, <span class="hljs-string">&quot;getCurrentDateTime&quot;</span>);<br><span class="hljs-type">ToolDefinition</span> <span class="hljs-variable">toolDefinition</span> <span class="hljs-operator">=</span> ToolDefinitions.builder(method)<br>    .name(<span class="hljs-string">&quot;currentDateTime&quot;</span>)  <span class="hljs-comment">// è¦†ç›–é»˜è®¤åç§°</span><br>    .description(<span class="hljs-string">&quot;è·å–ç”¨æˆ·æ—¶åŒºçš„å½“å‰æ—¥æœŸæ—¶é—´&quot;</span>)  <span class="hljs-comment">// è¦†ç›–é»˜è®¤æè¿°</span><br>    .build();<br></code></pre></td></tr></table></figure>

<h3 id="æ–¹å¼ä¸‰ï¼šFunctionToolCallbackï¼ˆå‡½æ•°å¼ï¼‰"><a href="#æ–¹å¼ä¸‰ï¼šFunctionToolCallbackï¼ˆå‡½æ•°å¼ï¼‰" class="headerlink" title="æ–¹å¼ä¸‰ï¼šFunctionToolCallbackï¼ˆå‡½æ•°å¼ï¼‰"></a>æ–¹å¼ä¸‰ï¼šFunctionToolCallbackï¼ˆå‡½æ•°å¼ï¼‰</h3><p>ä½¿ç”¨ <code>Function</code>ã€<code>Supplier</code>ã€<code>Consumer</code>ã€<code>BiFunction</code> ç­‰å‡½æ•°å¼æ¥å£å®šä¹‰å·¥å…·ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å®šä¹‰è¯·æ±‚/å“åº”ç±»å‹</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">WeatherRequest</span><span class="hljs-params">(String location, Unit unit)</span> &#123;&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">WeatherResponse</span><span class="hljs-params">(<span class="hljs-type">double</span> temp, Unit unit)</span> &#123;&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">Unit</span> &#123; C, F &#125;<br><br><span class="hljs-comment">// å®ç° Function æ¥å£</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WeatherFunction</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Function</span>&lt;WeatherRequest, WeatherResponse&gt; &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> WeatherResponse <span class="hljs-title function_">apply</span><span class="hljs-params">(WeatherRequest request)</span> &#123;<br>        <span class="hljs-comment">// è°ƒç”¨å¤©æ°” API</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeatherResponse</span>(<span class="hljs-number">25.0</span>, Unit.C);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// æ„å»º ToolCallback</span><br><span class="hljs-type">ToolCallback</span> <span class="hljs-variable">weatherTool</span> <span class="hljs-operator">=</span> FunctionToolCallback.builder(<span class="hljs-string">&quot;getWeather&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeatherFunction</span>())<br>    .description(<span class="hljs-string">&quot;è·å–æŒ‡å®šä½ç½®çš„å¤©æ°”ä¿¡æ¯&quot;</span>)<br>    .inputType(WeatherRequest.class)<br>    .build();<br><br><span class="hljs-comment">// æ³¨å†Œåˆ° ChatClient</span><br><span class="hljs-type">ChatClient</span> <span class="hljs-variable">chatClient</span> <span class="hljs-operator">=</span> ChatClient.builder(chatModel)<br>    .defaultTools(weatherTool)<br>    .build();<br></code></pre></td></tr></table></figure>

<h3 id="æ–¹å¼å››ï¼šå®ç°-ToolCallback-æ¥å£ï¼ˆå®Œå…¨è‡ªå®šä¹‰ï¼‰"><a href="#æ–¹å¼å››ï¼šå®ç°-ToolCallback-æ¥å£ï¼ˆå®Œå…¨è‡ªå®šä¹‰ï¼‰" class="headerlink" title="æ–¹å¼å››ï¼šå®ç° ToolCallback æ¥å£ï¼ˆå®Œå…¨è‡ªå®šä¹‰ï¼‰"></a>æ–¹å¼å››ï¼šå®ç° ToolCallback æ¥å£ï¼ˆå®Œå…¨è‡ªå®šä¹‰ï¼‰</h3><p>é€‚åˆå°è£… MCP å·¥å…·æˆ–æ„å»ºå¤æ‚çš„ Agent åº”ç”¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomToolCallback</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ToolCallback</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> ToolDefinition <span class="hljs-title function_">getToolDefinition</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> ToolDefinition.builder()<br>            .name(<span class="hljs-string">&quot;customTool&quot;</span>)<br>            .description(<span class="hljs-string">&quot;è‡ªå®šä¹‰å·¥å…·&quot;</span>)<br>            .inputSchema(<span class="hljs-string">&quot;&#123;...&#125;&quot;</span>)<br>            .build();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> ToolMetadata <span class="hljs-title function_">getToolMetadata</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> ToolMetadata.builder()<br>            .returnDirect(<span class="hljs-literal">false</span>)<br>            .build();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">call</span><span class="hljs-params">(String toolInput)</span> &#123;<br>        <span class="hljs-comment">// è§£æ toolInput (JSON)ï¼Œæ‰§è¡Œé€»è¾‘ï¼Œè¿”å›ç»“æœ</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;æ‰§è¡Œç»“æœ&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">call</span><span class="hljs-params">(String toolInput, ToolContext toolContext)</span> &#123;<br>        <span class="hljs-comment">// å¸¦ä¸Šä¸‹æ–‡çš„æ‰§è¡Œï¼Œå¯è®¿é—®ä¼šè¯å†å²ç­‰ä¿¡æ¯</span><br>        <span class="hljs-keyword">return</span> call(toolInput);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="æ³¨å†Œå’Œä½¿ç”¨å·¥å…·"><a href="#æ³¨å†Œå’Œä½¿ç”¨å·¥å…·" class="headerlink" title="æ³¨å†Œå’Œä½¿ç”¨å·¥å…·"></a>æ³¨å†Œå’Œä½¿ç”¨å·¥å…·</h2><h3 id="æ–¹å¼ä¸€ï¼šBuilder-çº§åˆ«æ³¨å†Œï¼ˆå…¨å±€é»˜è®¤ï¼‰"><a href="#æ–¹å¼ä¸€ï¼šBuilder-çº§åˆ«æ³¨å†Œï¼ˆå…¨å±€é»˜è®¤ï¼‰" class="headerlink" title="æ–¹å¼ä¸€ï¼šBuilder çº§åˆ«æ³¨å†Œï¼ˆå…¨å±€é»˜è®¤ï¼‰"></a>æ–¹å¼ä¸€ï¼šBuilder çº§åˆ«æ³¨å†Œï¼ˆå…¨å±€é»˜è®¤ï¼‰</h3><p>æ‰€æœ‰é€šè¿‡è¯¥ ChatClient å‘èµ·çš„è¯·æ±‚éƒ½å¯ä½¿ç”¨è¿™äº›å·¥å…·ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AiConfig</span> &#123;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> ChatClient <span class="hljs-title function_">chatClient</span><span class="hljs-params">(ChatModel chatModel, WeatherService weatherService)</span> &#123;<br>        <span class="hljs-keyword">return</span> ChatClient.builder(chatModel)<br>            .defaultTools(weatherService)  <span class="hljs-comment">// æ³¨å†Œé»˜è®¤å·¥å…·</span><br>            .build();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="æ–¹å¼äºŒï¼šè¯·æ±‚çº§åˆ«æ³¨å†Œï¼ˆæŒ‰éœ€ä½¿ç”¨ï¼‰"><a href="#æ–¹å¼äºŒï¼šè¯·æ±‚çº§åˆ«æ³¨å†Œï¼ˆæŒ‰éœ€ä½¿ç”¨ï¼‰" class="headerlink" title="æ–¹å¼äºŒï¼šè¯·æ±‚çº§åˆ«æ³¨å†Œï¼ˆæŒ‰éœ€ä½¿ç”¨ï¼‰"></a>æ–¹å¼äºŒï¼šè¯·æ±‚çº§åˆ«æ³¨å†Œï¼ˆæŒ‰éœ€ä½¿ç”¨ï¼‰</h3><p>é’ˆå¯¹ç‰¹å®šè¯·æ±‚æ³¨å†Œå·¥å…·ï¼Œä¼šè¦†ç›–é»˜è®¤å·¥å…·ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatService</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ChatClient chatClient;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> WeatherService weatherService;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> StockService stockService;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">chat</span><span class="hljs-params">(String userMessage)</span> &#123;<br>        <span class="hljs-keyword">return</span> chatClient.prompt()<br>            .user(userMessage)<br>            .tools(weatherService, stockService)  <span class="hljs-comment">// æœ¬æ¬¡è¯·æ±‚å¯ç”¨çš„å·¥å…·</span><br>            .call()<br>            .content();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="æ–¹å¼ä¸‰ï¼šé€šè¿‡åç§°å¼•ç”¨ï¼ˆéœ€é¢„å…ˆæ³¨å†Œï¼‰"><a href="#æ–¹å¼ä¸‰ï¼šé€šè¿‡åç§°å¼•ç”¨ï¼ˆéœ€é¢„å…ˆæ³¨å†Œï¼‰" class="headerlink" title="æ–¹å¼ä¸‰ï¼šé€šè¿‡åç§°å¼•ç”¨ï¼ˆéœ€é¢„å…ˆæ³¨å†Œï¼‰"></a>æ–¹å¼ä¸‰ï¼šé€šè¿‡åç§°å¼•ç”¨ï¼ˆéœ€é¢„å…ˆæ³¨å†Œï¼‰</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// é¢„å…ˆæ³¨å†Œå·¥å…·</span><br><span class="hljs-type">ChatClient</span> <span class="hljs-variable">chatClient</span> <span class="hljs-operator">=</span> ChatClient.builder(chatModel)<br>    .defaultToolCallbacks(weatherToolCallback)<br>    .build();<br><br><span class="hljs-comment">// é€šè¿‡åç§°å¼•ç”¨</span><br><span class="hljs-type">String</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> chatClient.prompt()<br>    .user(<span class="hljs-string">&quot;åŒ—äº¬å¤©æ°”å¦‚ä½•ï¼Ÿ&quot;</span>)<br>    .toolNames(<span class="hljs-string">&quot;getWeather&quot;</span>)<br>    .call()<br>    .content();<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="å‚æ•°å¤„ç†"><a href="#å‚æ•°å¤„ç†" class="headerlink" title="å‚æ•°å¤„ç†"></a>å‚æ•°å¤„ç†</h2><h3 id="ToolParam-æ³¨è§£è¯¦è§£"><a href="#ToolParam-æ³¨è§£è¯¦è§£" class="headerlink" title="@ToolParam æ³¨è§£è¯¦è§£"></a>@ToolParam æ³¨è§£è¯¦è§£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">BookingRequest</span><span class="hljs-params">(</span><br><span class="hljs-params">    @ToolParam(description = &quot;å‡ºå‘åŸå¸‚&quot;)</span> String from,<br>    <span class="hljs-meta">@ToolParam(description = &quot;ç›®çš„åŸå¸‚&quot;)</span> String to,<br>    <span class="hljs-meta">@ToolParam(description = &quot;å‡ºå‘æ—¥æœŸï¼Œæ ¼å¼ï¼šyyyy-MM-dd&quot;)</span> String date,<br>    <span class="hljs-meta">@ToolParam(description = &quot;èˆ±ä½ç±»å‹&quot;, required = false)</span> String cabinClass<br>) &#123;&#125;<br><br><span class="hljs-meta">@Tool(description = &quot;æŸ¥è¯¢èˆªç­ä¿¡æ¯&quot;)</span><br><span class="hljs-keyword">public</span> List&lt;Flight&gt; <span class="hljs-title function_">searchFlights</span><span class="hljs-params">(BookingRequest request)</span> &#123;<br>    <span class="hljs-comment">// æ”¯æŒå¤æ‚å¯¹è±¡ä½œä¸ºå‚æ•°</span><br>    <span class="hljs-keyword">return</span> flightService.search(request);<br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p><strong>ğŸ“ æ³¨æ„: å‚æ•°è§„åˆ™</strong></p>
<ul>
<li>é»˜è®¤æ‰€æœ‰å‚æ•°ä¸º<strong>å¿…éœ€</strong>ï¼Œé™¤éæ˜¾å¼æ ‡è®° <code>required = false</code></li>
<li>Spring AI è‡ªåŠ¨æ ¹æ® Java ç±»å‹ç”Ÿæˆ JSON Schema</li>
<li>æ”¯æŒåŸºæœ¬ç±»å‹ã€å¯¹è±¡ã€é›†åˆç­‰</li>
</ul>
</blockquote>
<h3 id="è‡ªåŠ¨-Schema-ç”Ÿæˆ"><a href="#è‡ªåŠ¨-Schema-ç”Ÿæˆ" class="headerlink" title="è‡ªåŠ¨ Schema ç”Ÿæˆ"></a>è‡ªåŠ¨ Schema ç”Ÿæˆ</h3><p>Spring AI æ ¹æ®æ–¹æ³•ç­¾åè‡ªåŠ¨ç”Ÿæˆè¾“å…¥ Schemaï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// Java æ–¹æ³•</span><br><span class="hljs-meta">@Tool(description = &quot;Set a user alarm&quot;)</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">setAlarm</span><span class="hljs-params">(<span class="hljs-meta">@ToolParam(description = &quot;Time in ISO-8601 format&quot;)</span> String time)</span><br><br><span class="hljs-comment">// è‡ªåŠ¨ç”Ÿæˆçš„ JSON Schema</span><br>&#123;<br>  <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;object&quot;</span>,<br>  <span class="hljs-string">&quot;properties&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;time&quot;</span>: &#123;<br>      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;string&quot;</span>,<br>      <span class="hljs-string">&quot;description&quot;</span>: <span class="hljs-string">&quot;Time in ISO-8601 format&quot;</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-string">&quot;required&quot;</span>: [<span class="hljs-string">&quot;time&quot;</span>]<br>&#125;<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="returnDirect-æœºåˆ¶"><a href="#returnDirect-æœºåˆ¶" class="headerlink" title="returnDirect æœºåˆ¶"></a>returnDirect æœºåˆ¶</h2><h3 id="é»˜è®¤è¡Œä¸º"><a href="#é»˜è®¤è¡Œä¸º" class="headerlink" title="é»˜è®¤è¡Œä¸º"></a>é»˜è®¤è¡Œä¸º</h3><p>å·¥å…·æ‰§è¡Œç»“æœè¿”å›ç»™ AI æ¨¡å‹ï¼Œæ¨¡å‹æ•´åˆåå†å“åº”ç”¨æˆ·ã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">ç”¨æˆ· â†’ æ¨¡å‹ â†’ è°ƒç”¨å·¥å…· â†’ å·¥å…·ç»“æœ â†’ æ¨¡å‹æ•´åˆ â†’ ç”¨æˆ·<br></code></pre></td></tr></table></figure>

<h3 id="returnDirect-true"><a href="#returnDirect-true" class="headerlink" title="returnDirect &#x3D; true"></a>returnDirect &#x3D; true</h3><p>å·¥å…·ç»“æœç›´æ¥è¿”å›ç»™ç”¨æˆ·ï¼Œè·³è¿‡æ¨¡å‹åå¤„ç†ã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">ç”¨æˆ· â†’ æ¨¡å‹ â†’ è°ƒç”¨å·¥å…· â†’ å·¥å…·ç»“æœ â†’ ç”¨æˆ·ï¼ˆç›´æ¥è¿”å›ï¼‰<br></code></pre></td></tr></table></figure>

<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>RAG æ£€ç´¢ç»“æœæ— éœ€å†åŠ å·¥</li>
<li>æŸäº›å·¥å…·ä½œä¸º Agent æ¨ç†å¾ªç¯çš„ç»ˆæ­¢ç‚¹</li>
<li>å‡å°‘ä¸å¿…è¦çš„ Token æ¶ˆè€—</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Tool(description = &quot;è·å–å›¾ä¹¦é¦†è¥ä¸šæ—¶é—´&quot;, returnDirect = true)</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">getLibraryHours</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;è¥ä¸šæ—¶é—´ï¼šå‘¨ä¸€è‡³å‘¨äº” 9:00-20:00ï¼Œå‘¨æœ« 10:00-18:00&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p><strong>âš ï¸ è­¦å‘Š: å¤šå·¥å…·è°ƒç”¨æ—¶çš„æ³¨æ„äº‹é¡¹</strong><br>å¦‚æœä¸€æ¬¡è¯·æ±‚è°ƒç”¨å¤šä¸ªå·¥å…·ï¼Œ<strong>æ‰€æœ‰å·¥å…·</strong>éƒ½å¿…é¡»è®¾ç½® <code>returnDirect = true</code> æ‰ä¼šç›´æ¥è¿”å›ã€‚å¦åˆ™ç»“æœä»ä¼šå‘é€ç»™æ¨¡å‹ã€‚</p>
</blockquote>
<hr>
<h2 id="Dynamic-Tool-Discoveryï¼ˆåŠ¨æ€å·¥å…·å‘ç°ï¼‰"><a href="#Dynamic-Tool-Discoveryï¼ˆåŠ¨æ€å·¥å…·å‘ç°ï¼‰" class="headerlink" title="Dynamic Tool Discoveryï¼ˆåŠ¨æ€å·¥å…·å‘ç°ï¼‰"></a>Dynamic Tool Discoveryï¼ˆåŠ¨æ€å·¥å…·å‘ç°ï¼‰</h2><p>å½“åº”ç”¨æ³¨å†Œäº†å¤§é‡å·¥å…·æ—¶ï¼ˆå‡ åç”šè‡³ä¸Šç™¾ä¸ªï¼‰ï¼Œå°†æ‰€æœ‰å·¥å…·å®šä¹‰å‘é€ç»™ LLM ä¼šæ¶ˆè€—å¤§é‡ Token å¹¶å½±å“æ€§èƒ½ã€‚Spring AI æä¾›äº†<strong>åŠ¨æ€å·¥å…·å‘ç°</strong>æœºåˆ¶æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<h3 id="æ ¸å¿ƒæ€æƒ³"><a href="#æ ¸å¿ƒæ€æƒ³" class="headerlink" title="æ ¸å¿ƒæ€æƒ³"></a>æ ¸å¿ƒæ€æƒ³</h3><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">ä¼ ç»Ÿæ–¹å¼ï¼šæ³¨å†Œ <span class="hljs-number">100</span> ä¸ªå·¥å…· â†’ å…¨éƒ¨å‘é€ç»™ <span class="hljs-keyword">LLM </span>â†’ Token çˆ†ç‚¸ ğŸ’¥<br><br>åŠ¨æ€å‘ç°ï¼šæ³¨å†Œ <span class="hljs-number">100</span> ä¸ªå·¥å…· â†’ åªå‘é€ ToolSearchTool â†’ <span class="hljs-keyword">LLM </span>æŒ‰éœ€æœç´¢ â†’ æŒ‰éœ€åŠ è½½<br></code></pre></td></tr></table></figure>

<h3 id="å·¥ä½œæµç¨‹"><a href="#å·¥ä½œæµç¨‹" class="headerlink" title="å·¥ä½œæµç¨‹"></a>å·¥ä½œæµç¨‹</h3><pre><code class=" mermaid">sequenceDiagram
    participant U as ç”¨æˆ·
    participant C as ChatClient
    participant S as ToolSearcher
    participant L as LLM

    Note over C,S: å¯åŠ¨æ—¶ï¼šç´¢å¼•æ‰€æœ‰å·¥å…·ï¼Œä½†ä¸å‘é€ç»™ LLM
    U-&gt;&gt;C: &quot;é˜¿å§†æ–¯ç‰¹ä¸¹å¤©æ°”å¦‚ä½•ï¼Ÿ&quot;
    C-&gt;&gt;L: Prompt + ToolSearchTool å®šä¹‰
    L-&gt;&gt;C: è°ƒç”¨ searchTools(&quot;weather&quot;)
    C-&gt;&gt;S: æœç´¢åŒ¹é…çš„å·¥å…·
    S-&gt;&gt;C: è¿”å› getWeather å·¥å…·å®šä¹‰
    C-&gt;&gt;L: è¡¥å…… getWeather å·¥å…·å®šä¹‰
    L-&gt;&gt;C: è°ƒç”¨ getWeather(&quot;Amsterdam&quot;)
    C-&gt;&gt;U: &quot;é˜¿å§†æ–¯ç‰¹ä¸¹å½“å‰å¤©æ°”...&quot;
</code></pre>

<h3 id="å®ç°æ–¹å¼"><a href="#å®ç°æ–¹å¼" class="headerlink" title="å®ç°æ–¹å¼"></a>å®ç°æ–¹å¼</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Application</span> &#123;<br><br>    <span class="hljs-meta">@Bean</span><br>    CommandLineRunner <span class="hljs-title function_">demo</span><span class="hljs-params">(ChatClient.Builder builder, ToolSearcher toolSearcher)</span> &#123;<br>        <span class="hljs-keyword">return</span> args -&gt; &#123;<br>            <span class="hljs-comment">// æ„å»º ToolSearchToolCallAdvisor</span><br>            <span class="hljs-type">var</span> <span class="hljs-variable">advisor</span> <span class="hljs-operator">=</span> ToolSearchToolCallAdvisor.builder()<br>                .toolSearcher(toolSearcher)<br>                .build();<br><br>            <span class="hljs-type">ChatClient</span> <span class="hljs-variable">chatClient</span> <span class="hljs-operator">=</span> builder<br>                .defaultTools(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyTools</span>())  <span class="hljs-comment">// æ³¨å†Œå¤§é‡å·¥å…·ï¼Œä½†ä¸ç«‹å³å‘é€ç»™ LLM</span><br>                .defaultAdvisors(advisor)     <span class="hljs-comment">// å¯ç”¨åŠ¨æ€å·¥å…·æœç´¢</span><br>                .build();<br><br>            <span class="hljs-type">var</span> <span class="hljs-variable">answer</span> <span class="hljs-operator">=</span> chatClient.prompt(<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">                å¸®æˆ‘è§„åˆ’ä»Šå¤©åœ¨é˜¿å§†æ–¯ç‰¹ä¸¹ç©¿ä»€ä¹ˆã€‚</span><br><span class="hljs-string">                è¯·æ¨èç°åœ¨è¥ä¸šçš„æœè£…åº—ã€‚</span><br><span class="hljs-string">                &quot;&quot;&quot;</span>).call().content();<br><br>            System.out.println(answer);<br>        &#125;;<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyTools</span> &#123;<br>        <span class="hljs-meta">@Tool(description = &quot;è·å–æŒ‡å®šä½ç½®å’Œæ—¶é—´çš„å¤©æ°”&quot;)</span><br>        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">weather</span><span class="hljs-params">(String location,</span><br><span class="hljs-params">            <span class="hljs-meta">@ToolParam(description = &quot;æ ¼å¼ï¼šYYYY-MM-DDTHH:mm&quot;)</span> String atTime)</span> &#123;<br>            <span class="hljs-comment">// å®ç°</span><br>        &#125;<br><br>        <span class="hljs-meta">@Tool(description = &quot;è·å–æŒ‡å®šä½ç½®å’Œæ—¶é—´è¥ä¸šçš„æœè£…åº—&quot;)</span><br>        <span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title function_">clothing</span><span class="hljs-params">(String location,</span><br><span class="hljs-params">            <span class="hljs-meta">@ToolParam(description = &quot;æ ¼å¼ï¼šYYYY-MM-DDTHH:mm&quot;)</span> String openAtTime)</span> &#123;<br>            <span class="hljs-comment">// å®ç°</span><br>        &#125;<br><br>        <span class="hljs-meta">@Tool(description = &quot;è·å–æŒ‡å®šä½ç½®çš„å½“å‰æ—¥æœŸæ—¶é—´&quot;)</span><br>        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">currentTime</span><span class="hljs-params">(String location)</span> &#123;<br>            <span class="hljs-comment">// å®ç°</span><br>        &#125;<br><br>        <span class="hljs-comment">// ... å¯èƒ½æœ‰ä¸Šç™¾ä¸ªå·¥å…·</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="å…³é”®ç»„ä»¶-1"><a href="#å…³é”®ç»„ä»¶-1" class="headerlink" title="å…³é”®ç»„ä»¶"></a>å…³é”®ç»„ä»¶</h3><table>
<thead>
<tr>
<th>ç»„ä»¶</th>
<th>èŒè´£</th>
</tr>
</thead>
<tbody><tr>
<td><code>ToolSearcher</code></td>
<td>ç´¢å¼•æ‰€æœ‰å·¥å…·ï¼Œæä¾›æœç´¢èƒ½åŠ›</td>
</tr>
<tr>
<td><code>ToolSearchToolCallAdvisor</code></td>
<td>Advisorï¼Œæ‹¦æˆªè¯·æ±‚å¹¶å¯ç”¨åŠ¨æ€æœç´¢</td>
</tr>
<tr>
<td><code>ToolSearchTool</code></td>
<td>æš´éœ²ç»™ LLM çš„å…ƒå·¥å…·ï¼Œç”¨äºæœç´¢å…¶ä»–å·¥å…·</td>
</tr>
</tbody></table>
<h3 id="é€‚ç”¨åœºæ™¯"><a href="#é€‚ç”¨åœºæ™¯" class="headerlink" title="é€‚ç”¨åœºæ™¯"></a>é€‚ç”¨åœºæ™¯</h3><ul>
<li>å·¥å…·æ•°é‡å¤šï¼ˆ&gt;10 ä¸ªï¼‰</li>
<li>å•æ¬¡å¯¹è¯é€šå¸¸åªç”¨å°‘æ•°å‡ ä¸ªå·¥å…·</li>
<li>éœ€è¦ä¼˜åŒ– Token æ¶ˆè€—å’Œå“åº”é€Ÿåº¦</li>
</ul>
<hr>
<h2 id="å·¥å…·æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ"><a href="#å·¥å…·æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="å·¥å…·æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ"></a>å·¥å…·æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ</h2><h3 id="ToolCallingManager"><a href="#ToolCallingManager" class="headerlink" title="ToolCallingManager"></a>ToolCallingManager</h3><p><code>ToolCallingManager</code> æ˜¯ç®¡ç†å·¥å…·æ‰§è¡Œçš„æ ¸å¿ƒæ¥å£ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ToolCallingManager</span> &#123;<br><br>    <span class="hljs-comment">// ä»é…ç½®ä¸­è§£æå·¥å…·å®šä¹‰</span><br>    List&lt;ToolDefinition&gt; <span class="hljs-title function_">resolveToolDefinitions</span><span class="hljs-params">(ToolCallingChatOptions chatOptions)</span>;<br><br>    <span class="hljs-comment">// æ‰§è¡Œæ¨¡å‹è¯·æ±‚çš„å·¥å…·è°ƒç”¨</span><br>    ToolExecutionResult <span class="hljs-title function_">executeToolCalls</span><span class="hljs-params">(Prompt prompt, ChatResponse chatResponse)</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="å†…éƒ¨æ‰§è¡Œ-vs-ç”¨æˆ·æ§åˆ¶æ‰§è¡Œ"><a href="#å†…éƒ¨æ‰§è¡Œ-vs-ç”¨æˆ·æ§åˆ¶æ‰§è¡Œ" class="headerlink" title="å†…éƒ¨æ‰§è¡Œ vs ç”¨æˆ·æ§åˆ¶æ‰§è¡Œ"></a>å†…éƒ¨æ‰§è¡Œ vs ç”¨æˆ·æ§åˆ¶æ‰§è¡Œ</h3><h4 id="å†…éƒ¨æ‰§è¡Œï¼ˆé»˜è®¤ï¼‰"><a href="#å†…éƒ¨æ‰§è¡Œï¼ˆé»˜è®¤ï¼‰" class="headerlink" title="å†…éƒ¨æ‰§è¡Œï¼ˆé»˜è®¤ï¼‰"></a>å†…éƒ¨æ‰§è¡Œï¼ˆé»˜è®¤ï¼‰</h4><p>Spring AI è‡ªåŠ¨å¤„ç†å·¥å…·è°ƒç”¨å¾ªç¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> chatClient.prompt()<br>    .user(<span class="hljs-string">&quot;åŒ—äº¬å’Œä¸Šæµ·çš„å¤©æ°”å¦‚ä½•ï¼Ÿ&quot;</span>)<br>    .tools(weatherService)<br>    .call()<br>    .content();<br><span class="hljs-comment">// Spring AI è‡ªåŠ¨ï¼šè°ƒç”¨å·¥å…· â†’ è¿”å›ç»“æœç»™æ¨¡å‹ â†’ è·å–æœ€ç»ˆå“åº”</span><br></code></pre></td></tr></table></figure>

<h4 id="ç”¨æˆ·æ§åˆ¶æ‰§è¡Œ"><a href="#ç”¨æˆ·æ§åˆ¶æ‰§è¡Œ" class="headerlink" title="ç”¨æˆ·æ§åˆ¶æ‰§è¡Œ"></a>ç”¨æˆ·æ§åˆ¶æ‰§è¡Œ</h4><p>æ‰‹åŠ¨ç®¡ç†å·¥å…·è°ƒç”¨ï¼Œé€‚åˆéœ€è¦è‡ªå®šä¹‰é€»è¾‘çš„åœºæ™¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">ChatOptions</span> <span class="hljs-variable">chatOptions</span> <span class="hljs-operator">=</span> ToolCallingChatOptions.builder()<br>    .toolCallbacks(<span class="hljs-keyword">new</span> <span class="hljs-title class_">WeatherService</span>())<br>    .internalToolExecutionEnabled(<span class="hljs-literal">false</span>)  <span class="hljs-comment">// ç¦ç”¨å†…éƒ¨æ‰§è¡Œ</span><br>    .build();<br><br><span class="hljs-type">Prompt</span> <span class="hljs-variable">prompt</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Prompt</span>(List.of(<span class="hljs-keyword">new</span> <span class="hljs-title class_">UserMessage</span>(<span class="hljs-string">&quot;åŒ—äº¬å¤©æ°”å¦‚ä½•ï¼Ÿ&quot;</span>)), chatOptions);<br><span class="hljs-type">ChatResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> chatModel.call(prompt);<br><br><span class="hljs-comment">// æ‰‹åŠ¨æ£€æŸ¥å’Œæ‰§è¡Œå·¥å…·è°ƒç”¨</span><br><span class="hljs-keyword">while</span> (response.hasToolCalls()) &#123;<br>    <span class="hljs-type">ToolExecutionResult</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> toolCallingManager.executeToolCalls(prompt, response);<br>    <span class="hljs-comment">// è‡ªå®šä¹‰å¤„ç†é€»è¾‘...</span><br>    prompt = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Prompt</span>(result.conversationHistory(), chatOptions);<br>    response = chatModel.call(prompt);<br>&#125;<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="å®Œæ•´å®æˆ˜ç¤ºä¾‹"><a href="#å®Œæ•´å®æˆ˜ç¤ºä¾‹" class="headerlink" title="å®Œæ•´å®æˆ˜ç¤ºä¾‹"></a>å®Œæ•´å®æˆ˜ç¤ºä¾‹</h2><h3 id="åœºæ™¯ï¼šæ™ºèƒ½å®¢æœç³»ç»Ÿ"><a href="#åœºæ™¯ï¼šæ™ºèƒ½å®¢æœç³»ç»Ÿ" class="headerlink" title="åœºæ™¯ï¼šæ™ºèƒ½å®¢æœç³»ç»Ÿ"></a>åœºæ™¯ï¼šæ™ºèƒ½å®¢æœç³»ç»Ÿ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomerServiceTools</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> OrderRepository orderRepository;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ProductRepository productRepository;<br><br>    <span class="hljs-meta">@Tool(description = &quot;æ ¹æ®è®¢å•å·æŸ¥è¯¢è®¢å•çŠ¶æ€&quot;)</span><br>    <span class="hljs-keyword">public</span> OrderInfo <span class="hljs-title function_">queryOrder</span><span class="hljs-params">(</span><br><span class="hljs-params">            <span class="hljs-meta">@ToolParam(description = &quot;è®¢å•å·ï¼Œæ ¼å¼ï¼šORD-XXXXXXXX&quot;)</span> String orderId)</span> &#123;<br>        <span class="hljs-keyword">return</span> orderRepository.findById(orderId)<br>            .map(order -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderInfo</span>(order.getStatus(), order.getEstimatedDelivery()))<br>            .orElseThrow(() -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;è®¢å•ä¸å­˜åœ¨&quot;</span>));<br>    &#125;<br><br>    <span class="hljs-meta">@Tool(description = &quot;æŸ¥è¯¢å•†å“åº“å­˜&quot;)</span><br>    <span class="hljs-keyword">public</span> StockInfo <span class="hljs-title function_">checkStock</span><span class="hljs-params">(</span><br><span class="hljs-params">            <span class="hljs-meta">@ToolParam(description = &quot;å•†å“SKUç¼–ç &quot;)</span> String sku,</span><br><span class="hljs-params">            <span class="hljs-meta">@ToolParam(description = &quot;ä»“åº“ä»£ç &quot;, required = false)</span> String warehouse)</span> &#123;<br>        <span class="hljs-keyword">return</span> productRepository.checkStock(sku, warehouse);<br>    &#125;<br><br>    <span class="hljs-meta">@Tool(description = &quot;æäº¤é€€æ¬¾ç”³è¯·&quot;, returnDirect = true)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">submitRefund</span><span class="hljs-params">(</span><br><span class="hljs-params">            <span class="hljs-meta">@ToolParam(description = &quot;è®¢å•å·&quot;)</span> String orderId,</span><br><span class="hljs-params">            <span class="hljs-meta">@ToolParam(description = &quot;é€€æ¬¾åŸå› &quot;)</span> String reason)</span> &#123;<br>        <span class="hljs-comment">// å¤„ç†é€€æ¬¾é€»è¾‘</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">refundId</span> <span class="hljs-operator">=</span> refundService.submit(orderId, reason);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;é€€æ¬¾ç”³è¯·å·²æäº¤ï¼Œé€€æ¬¾å•å·ï¼š&quot;</span> + refundId + <span class="hljs-string">&quot;ï¼Œé¢„è®¡ 3-5 ä¸ªå·¥ä½œæ—¥åˆ°è´¦ã€‚&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@RequestMapping(&quot;/api/chat&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatController</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ChatClient chatClient;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ChatController</span><span class="hljs-params">(ChatModel chatModel, CustomerServiceTools tools)</span> &#123;<br>        <span class="hljs-built_in">this</span>.chatClient = ChatClient.builder(chatModel)<br>            .defaultSystem(<span class="hljs-string">&quot;ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å®¢æœåŠ©æ‰‹ï¼Œè¯·ç¤¼è²Œåœ°å¸®åŠ©ç”¨æˆ·è§£å†³é—®é¢˜ã€‚&quot;</span>)<br>            .defaultTools(tools)<br>            .build();<br>    &#125;<br><br>    <span class="hljs-meta">@PostMapping</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">chat</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> ChatRequest request)</span> &#123;<br>        <span class="hljs-keyword">return</span> chatClient.prompt()<br>            .user(request.message())<br>            .call()<br>            .content();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="ä¸å…¶ä»–æŠ€æœ¯çš„å…³ç³»"><a href="#ä¸å…¶ä»–æŠ€æœ¯çš„å…³ç³»" class="headerlink" title="ä¸å…¶ä»–æŠ€æœ¯çš„å…³ç³»"></a>ä¸å…¶ä»–æŠ€æœ¯çš„å…³ç³»</h2><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs nix">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br>â”‚                    Spring AI Tool Calling                    â”‚<br>â”‚         ï¼ˆJava ç”Ÿæ€çš„ AI å·¥å…·è°ƒç”¨ç»Ÿä¸€æŠ½è±¡å±‚ï¼‰                 â”‚<br>â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤<br>â”‚                     å„å‚å•† Function Calling                  â”‚<br>â”‚    OpenAI <span class="hljs-symbol">/</span> Claude <span class="hljs-symbol">/</span> é€šä¹‰åƒé—® <span class="hljs-symbol">/</span> Gemini <span class="hljs-symbol">/</span> æ–‡å¿ƒä¸€è¨€ ç­‰         â”‚<br>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<br></code></pre></td></tr></table></figure>

<p>Spring AI Tool Calling çš„ä»·å€¼ï¼š</p>
<ol>
<li><strong>ç»Ÿä¸€ API</strong>ï¼šå±è”½å„å‚å•† Function Calling çš„å®ç°å·®å¼‚</li>
<li><strong>Spring å‹å¥½</strong>ï¼šæ³¨è§£é©±åŠ¨ã€ä¾èµ–æ³¨å…¥ã€ä¸ Spring ç”Ÿæ€æ— ç¼é›†æˆ</li>
<li><strong>ç±»å‹å®‰å…¨</strong>ï¼šè‡ªåŠ¨ JSON Schema ç”Ÿæˆï¼Œç¼–è¯‘æœŸæ£€æŸ¥</li>
<li><strong>å¯æ‰©å±•</strong>ï¼šé€šè¿‡ <code>ToolCallback</code> æ¥å£å¯¹æ¥ä»»æ„å·¥å…·æ¥æºï¼ˆå¦‚ MCPï¼‰</li>
</ol>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><table>
<thead>
<tr>
<th>è¦ç‚¹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><strong>å®šä¹‰å·¥å…·</strong></td>
<td>å£°æ˜å¼ <code>@Tool</code> æˆ–ç¼–ç¨‹å¼ <code>MethodToolCallback</code> &#x2F; <code>FunctionToolCallback</code></td>
</tr>
<tr>
<td><strong>æ³¨å†Œå·¥å…·</strong></td>
<td>Builder çº§åˆ«ï¼ˆå…¨å±€ï¼‰æˆ–è¯·æ±‚çº§åˆ«ï¼ˆæŒ‰éœ€ï¼‰</td>
</tr>
<tr>
<td><strong>åŠ¨æ€å‘ç°</strong></td>
<td><code>ToolSearchToolCallAdvisor</code> å®ç°æŒ‰éœ€åŠ è½½ï¼Œä¼˜åŒ– Token</td>
</tr>
<tr>
<td><strong>æ‰§è¡Œæ§åˆ¶</strong></td>
<td>é»˜è®¤å†…éƒ¨è‡ªåŠ¨å¾ªç¯ï¼Œå¯åˆ‡æ¢ä¸ºæ‰‹åŠ¨æ§åˆ¶</td>
</tr>
<tr>
<td><strong>è¿”å›ç­–ç•¥</strong></td>
<td><code>returnDirect=true</code> å¯è·³è¿‡æ¨¡å‹åå¤„ç†</td>
</tr>
<tr>
<td><strong>æ ¸å¿ƒæ¥å£</strong></td>
<td><code>ToolCallback</code> æ˜¯æ‰©å±•ç‚¹ï¼Œ<code>ToolCallingManager</code> ç®¡ç†ç”Ÿå‘½å‘¨æœŸ</td>
</tr>
</tbody></table>
<hr>
<h2 id="ç›¸å…³é“¾æ¥"><a href="#ç›¸å…³é“¾æ¥" class="headerlink" title="ç›¸å…³é“¾æ¥"></a>ç›¸å…³é“¾æ¥</h2><ul>
<li>Agent å·¥å…·è°ƒç”¨æŠ€æœ¯è¯¦è§£ - Function Calling &#x2F; MCP &#x2F; Skills å¯¹æ¯”</li>
<li>WebFlux ç®€ä»‹ - å“åº”å¼ç¼–ç¨‹åŸºç¡€ï¼ˆSpring AI æ”¯æŒå“åº”å¼ï¼‰</li>
</ul>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Java/" class="category-chain-item">Java</a>
  
  
    <span>></span>
    
  <a href="/categories/Java/Spring/" class="category-chain-item">Spring</a>
  
  
    <span>></span>
    
  <a href="/categories/Java/Spring/SpringAI/" class="category-chain-item">SpringAI</a>
  
  

  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Agent/" class="print-no-link">#Agent</a>
      
        <a href="/tags/FunctionCalling/" class="print-no-link">#FunctionCalling</a>
      
        <a href="/tags/AI/" class="print-no-link">#AI</a>
      
        <a href="/tags/SpringAI/" class="print-no-link">#SpringAI</a>
      
        <a href="/tags/ToolCalling/" class="print-no-link">#ToolCalling</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Tool Callingè¯¦è§£</div>
      <div>https://zmmmmy.github.io/2026/01/28/Tool Callingè¯¦è§£/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>ZhiMy</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2026å¹´1æœˆ28æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2026/02/09/AI-Coding%E6%A6%82%E5%BF%B5%E5%85%A8%E6%99%AF/" title="AI-Codingæ¦‚å¿µå…¨æ™¯">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">AI-Codingæ¦‚å¿µå…¨æ™¯</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2026/01/22/MCP%E5%B7%A5%E5%85%B7%E5%88%97%E8%A1%A8%E8%8E%B7%E5%8F%96%E6%9C%BA%E5%88%B6/" title="MCPå·¥å…·åˆ—è¡¨è·å–æœºåˆ¶">
                        <span class="hidden-mobile">MCPå·¥å…·åˆ—è¡¨è·å–æœºåˆ¶</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  





  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/10.9.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});

    Fluid.utils.listenDOMLoaded(function() {
      Fluid.events.registerRefreshCallback(function() {
        if ('mermaid' in window) {
          mermaid.init();
        }
      });
    });
  });
</script>






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <span>Â© 2026</span> <i class="iconfont icon-love"></i> <a href="https://github.com/Zmmmmy" target="_blank" rel="nofollow noopener"><span>Zmmmmy</span></a> <span>|</span> <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <span>&</span> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        æ€»è®¿é—®é‡ 
        <span id="busuanzi_value_site_pv"></span>
         æ¬¡
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        æ€»è®¿å®¢æ•° 
        <span id="busuanzi_value_site_uv"></span>
         äºº
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  

<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
